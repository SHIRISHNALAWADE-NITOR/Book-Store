<div class="payment-container">
  <h2>Payment Information</h2>

  <!-- Layout with Address Selection on the Right -->
  <div class="row">
    <!-- Address Selection -->
    <div class="col-md-4">
      <div>
        <label for="addressSelect">Select Address:</label>
        <select id="addressSelect" (change)="onAddressSelect($event)">
          <option *ngFor="let address of addresses" [value]="address.addressId">
            {{ address.street }}, {{ address.city }}, {{ address.state }} {{ address.postalCode }}
          </option>
        </select>
      </div>
    </div>

    <!-- Display User and Address Information -->
    <div class="col-md-8">
      <div class="user-info">
        <h3>Customer Information</h3>
        <p><strong>Name:</strong> {{ paymentDetails.name }}</p>
        <p><strong>Email:</strong> {{ paymentDetails.email }}</p>
        <p><strong>Phone:</strong> {{ paymentDetails.phone }}</p>
        <h3>Address</h3>
        <p><strong>Address:</strong> {{ paymentDetails.address }}, {{ paymentDetails.city }}, {{ paymentDetails.state }}, {{ paymentDetails.postalCode }}</p>
      </div>

      <!-- Payment Form -->
      <form (ngSubmit)="submitPayment()">
        <!-- Card Details -->
        <div class="form-group">
          <label for="cardNumber">Card Number</label>
          <input id="cardNumber" [(ngModel)]="paymentDetails.cardNumber" name="cardNumber" minlength="12" maxlength="12" class="form-control" type="text" required />
        </div>

        <div class="form-group">
          <label for="cvv">CVV</label>
          <input id="cvv" [(ngModel)]="paymentDetails.cvv" name="cvv" class="form-control" minlength="3" maxlength="3" type="text" required />
        </div>

        <!-- Order Summary -->
        <div class="order-summary">
          <h3>Order Summary</h3>
          <p><strong>Items:</strong> {{ totalItems }}</p>
          <p><strong>Total Amount:</strong> ₹{{ order.totalAmount | number:'1.2-2' }}</p>
        </div>
        
        <button type="submit" class="btn btn-primary">Submit Payment</button>
      </form>

      <button class="btn btn-secondary mt-3" (click)="printBill()" *ngIf="isPaymentDetailsValid()">Print Bill</button>
    </div>
  </div>

  <!-- Printable Bill Area -->
  <div id="printableArea" style="display: none;">
    <div class="card">
      <h1>Invoice</h1>
      <h2>Customer Information</h2>
      <p><strong>Name:</strong> {{ paymentDetails.name }}</p>
      <p><strong>Email:</strong> {{ paymentDetails.email }}</p>
      <p><strong>Phone:</strong> {{ paymentDetails.phone }}</p>
      <h2>Address</h2>
      <p><strong>Address:</strong> {{ paymentDetails.address }}, {{ paymentDetails.city }}, {{ paymentDetails.state }}, {{ paymentDetails.postalCode }}</p>
      <div *ngIf="order.orderItems && order.orderItems.length > 0">
        <h2>Books Ordered</h2>
        <div class="books-container">
          <div *ngFor="let item of order.orderItems" class="book-card">
            <h3 class="book-title">{{ item.title }}</h3>
            <p><strong>Author:</strong> {{ item.author }}</p>
            <p><strong>Price:</strong> ₹{{ item.price | number:'1.2-2' }}</p>
            <p><strong>Quantity:</strong> {{ item.quantity }}</p>
          </div>
        </div>
      </div>
      <h3>Order Summary</h3>
      <p><strong>Items:</strong> {{ totalItems }}</p>
      <p><strong>Total Amount:</strong> ₹{{ order.totalAmount | number:'1.2-2' }}</p>
    </div>
  </div>
</div>
